import{_ as U,c as P,o as h,b as n,e,w as l,p as k,v as q,f as c,t as S,x as te,y as le,z as ae,k as R,r as w,A as G,j as A,i as I,F as oe,B as se,C as T,q as g,m as B,D as H,G as K,H as Q,I as W,J as ne,K as ie,L as de,M as re,g as ue,N as ce,s as J,E as D}from"./index-IB4G3YSI.js";import{s as pe,A as me,a as ve,u as fe,g as _e,b as be,d as ge,c as ye,e as ke,f as Ce}from"./animations-CK8lbZP1.js";import{u as X}from"./useResponsive-D_ioosfI.js";import"./request-C3WSFEwG.js";const he={class:"stats-grid"},we={class:"stat-card card-modern hover-lift stagger-item"},Ve={class:"stat-icon",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},je={class:"stat-content"},$e={class:"stat-value"},xe={class:"stat-card card-modern hover-lift stagger-item"},Pe={class:"stat-icon",style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"}},Se={class:"stat-content"},De={class:"stat-value"},Be={class:"stat-card card-modern hover-lift stagger-item"},Ie={class:"stat-icon",style:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"}},Ue={class:"stat-content"},Te={class:"stat-value"},Ae={class:"stat-card card-modern hover-lift stagger-item"},Ne={class:"stat-icon",style:{background:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"}},ze={class:"stat-content"},Ee={class:"stat-value"},Me={__name:"ProjectStatsGrid",props:{totalCount:{type:Number,default:0},paidCount:{type:Number,default:0},freeCount:{type:Number,default:0}},setup(p){return(j,d)=>{const m=c("el-icon");return h(),P("div",he,[n("div",we,[n("div",Ve,[e(m,null,{default:l(()=>[e(k(q))]),_:1})]),n("div",je,[d[0]||(d[0]=n("div",{class:"stat-label"},"总项目数",-1)),n("div",$e,S(p.totalCount),1)])]),n("div",xe,[n("div",Pe,[e(m,null,{default:l(()=>[e(k(te))]),_:1})]),n("div",Se,[d[1]||(d[1]=n("div",{class:"stat-label"},"付费项目",-1)),n("div",De,S(p.paidCount),1)])]),n("div",Be,[n("div",Ie,[e(m,null,{default:l(()=>[e(k(le))]),_:1})]),n("div",Ue,[d[2]||(d[2]=n("div",{class:"stat-label"},"免费项目",-1)),n("div",Te,S(p.freeCount),1)])]),n("div",Ae,[n("div",Ne,[e(m,null,{default:l(()=>[e(k(ae))]),_:1})]),n("div",ze,[d[3]||(d[3]=n("div",{class:"stat-label"},"活跃项目",-1)),n("div",Ee,S(p.totalCount),1)])])])}}},Fe=U(Me,[["__scopeId","data-v-720a045d"]]),Le=["onClick"],Oe={class:"card-header"},Re={class:"card-title"},Je={class:"project-name"},qe={class:"card-body"},Ge={class:"info-row"},He={class:"value text-ellipsis"},Ke={class:"info-row"},Qe={class:"value"},We={class:"info-row"},Xe={class:"tags"},Ye={class:"card-footer"},Ze={key:0,class:"loading-state"},et={key:1,class:"empty-state"},tt={__name:"ProjectCardList",props:{projects:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},selectedProjects:{type:Array,default:()=>[]}},emits:["selection-change","edit","view-cards","view-vars","delete"],setup(p,{emit:j}){const d=p,m=j,f=R({get:()=>d.selectedProjects.map(s=>s.id),set:s=>{const t=d.projects.filter(v=>s.includes(v.id));m("selection-change",t)}}),u=s=>{},i=w(null);G(()=>{V()}),A(()=>d.projects,()=>{d.projects.length>0&&setTimeout(()=>{V()},50)});const V=()=>{if(i.value){const s=i.value.querySelectorAll(".project-card");s.length>0&&pe(s,{stagger:.05,ease:"back.out(1.7)"})}};return(s,t)=>{const v=c("el-checkbox"),_=c("el-tag"),o=c("el-icon"),C=c("el-button");return h(),P("div",{class:"project-card-list",ref_key:"cardListRef",ref:i},[(h(!0),P(oe,null,se(p.projects,a=>(h(),P("div",{key:a.id,class:"project-card",onClick:$=>u()},[n("div",Oe,[n("div",Re,[e(v,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=$=>f.value=$),label:a.id,onClick:t[1]||(t[1]=T(()=>{},["stop"])),class:"card-checkbox"},null,8,["modelValue","label"]),n("span",Je,S(a.name),1)]),e(_,{type:a.mode==="paid"?"success":"info",size:"small"},{default:l(()=>[g(S(a.mode==="paid"?"付费":"免费"),1)]),_:2},1032,["type"])]),n("div",qe,[n("div",Ge,[t[2]||(t[2]=n("span",{class:"label"},"UUID",-1)),n("span",He,S(a.uuid),1)]),n("div",Ke,[t[3]||(t[3]=n("span",{class:"label"},"版本",-1)),n("span",Qe,S(a.version),1)]),n("div",We,[t[6]||(t[6]=n("span",{class:"label"},"配置",-1)),n("div",Xe,[a.enable_hwid?(h(),B(_,{key:0,size:"small",type:"info"},{default:l(()=>[...t[4]||(t[4]=[g("机器码",-1)])]),_:1})):I("",!0),a.enable_ip?(h(),B(_,{key:1,size:"small",type:"info"},{default:l(()=>[...t[5]||(t[5]=[g("IP验证",-1)])]),_:1})):I("",!0)])])]),n("div",Ye,[e(C,{size:"small",onClick:T($=>s.$emit("edit",a),["stop"])},{default:l(()=>[e(o,null,{default:l(()=>[e(k(H))]),_:1}),t[7]||(t[7]=g(" 编辑 ",-1))]),_:1},8,["onClick"]),e(C,{size:"small",type:"primary",onClick:T($=>s.$emit("view-cards",a),["stop"])},{default:l(()=>[e(o,null,{default:l(()=>[e(k(K))]),_:1}),t[8]||(t[8]=g(" 卡密 ",-1))]),_:1},8,["onClick"]),e(C,{size:"small",type:"success",onClick:T($=>s.$emit("view-vars",a),["stop"])},{default:l(()=>[e(o,null,{default:l(()=>[e(k(Q))]),_:1}),t[9]||(t[9]=g(" 变量 ",-1))]),_:1},8,["onClick"]),e(C,{size:"small",type:"danger",onClick:T($=>s.$emit("delete",a),["stop"])},{default:l(()=>[e(o,null,{default:l(()=>[e(k(W))]),_:1})]),_:1},8,["onClick"])])],8,Le))),128)),p.loading?(h(),P("div",Ze,[e(o,{class:"is-loading"},{default:l(()=>[e(k(ne))]),_:1}),t[10]||(t[10]=n("span",null,"加载中...",-1))])):I("",!0),!p.loading&&p.projects.length===0?(h(),P("div",et,[e(o,null,{default:l(()=>[e(k(q))]),_:1}),t[11]||(t[11]=n("span",null,"暂无项目",-1))])):I("",!0)],512)}}},lt=U(tt,[["__scopeId","data-v-64896d41"]]),at={__name:"ProjectTable",props:{projects:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["selection-change","edit","view-cards","view-vars","delete"],setup(p,{emit:j}){const{isMobile:d,isDesktop:m}=X(),f=w([]),u=j,i=s=>{f.value=s,u("selection-change",s)},V=s=>[{key:"edit",icon:H,label:"编辑",handler:()=>u("edit",s)},{key:"cards",icon:K,label:"卡密",handler:()=>u("view-cards",s)},{key:"vars",icon:Q,label:"变量",handler:()=>u("view-vars",s)},{key:"delete",icon:W,label:"删除",type:"danger",divided:!0,handler:()=>u("delete",s)}];return(s,t)=>{const v=c("el-table-column"),_=c("el-tag"),o=c("el-table"),C=ie("loading");return h(),P("div",null,[k(d)?(h(),B(lt,{key:1,projects:p.projects,loading:p.loading,"selected-projects":f.value,onSelectionChange:i,onEdit:t[0]||(t[0]=a=>s.$emit("edit",a)),onViewCards:t[1]||(t[1]=a=>s.$emit("view-cards",a)),onViewVars:t[2]||(t[2]=a=>s.$emit("view-vars",a)),onDelete:t[3]||(t[3]=a=>s.$emit("delete",a))},null,8,["projects","loading","selected-projects"])):de((h(),B(o,{key:0,data:p.projects,style:{width:"100%"},onSelectionChange:i},{default:l(()=>[e(v,{type:"selection",width:"55"}),e(v,{prop:"name",label:"项目名称","min-width":"120"}),e(v,{prop:"uuid",label:"项目UUID","min-width":"280","show-overflow-tooltip":""}),e(v,{prop:"mode",label:"模式",width:"100"},{default:l(({row:a})=>[e(_,{type:a.mode==="paid"?"success":"info"},{default:l(()=>[g(S(a.mode==="paid"?"付费":"免费"),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"version",label:"版本",width:"100"}),e(v,{label:"配置",width:"180"},{default:l(({row:a})=>[a.enable_hwid?(h(),B(_,{key:0,size:"small",style:{"margin-right":"5px"}},{default:l(()=>[...t[4]||(t[4]=[g("机器码",-1)])]),_:1})):I("",!0),a.enable_ip?(h(),B(_,{key:1,size:"small"},{default:l(()=>[...t[5]||(t[5]=[g("IP验证",-1)])]),_:1})):I("",!0)]),_:1}),e(v,{label:"操作",width:"250",fixed:k(m)?"right":!1,"class-name":"action-column"},{default:l(({row:a})=>[e(me,{actions:V(a)},null,8,["actions"])]),_:1},8,["fixed"])]),_:1},8,["data"])),[[C,p.loading]])])}}},ot=U(at,[["__scopeId","data-v-b561372a"]]),st={class:"modern-dialog theme-primary"},nt={__name:"ProjectFormDialog",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"创建项目"},projectData:{type:Object,default:null}},emits:["update:visible","save"],setup(p,{emit:j}){const{isMobile:d}=X(),m=p,f=j,u=w(!1),i=w({name:"",mode:"free",version:"1.0.0",update_url:"",token_expire:3600,enable_hwid:!0,enable_ip:!0,description:""});A(()=>m.visible,_=>{u.value=_,_&&(m.projectData?i.value={...m.projectData}:V())}),A(u,_=>{f("update:visible",_)});const V=()=>{i.value={name:"",mode:"free",version:"1.0.0",update_url:"",token_expire:3600,enable_hwid:!0,enable_ip:!0,description:""}},s=()=>{u.value=!1},t=()=>{f("save",i.value)},v=()=>{re(()=>{const _=document.querySelectorAll(".el-form-item");_.length>0&&ve(_)})};return(_,o)=>{const C=c("el-input"),a=c("el-form-item"),$=c("el-radio"),M=c("el-radio-group"),N=c("el-switch"),F=c("el-form"),z=c("el-button"),L=c("el-dialog");return h(),P("div",st,[e(L,{modelValue:u.value,"onUpdate:modelValue":o[8]||(o[8]=y=>u.value=y),title:p.title,width:k(d)?"95%":"600px",fullscreen:k(d),"close-on-click-modal":!1,onClose:s,onOpened:v},{footer:l(()=>[e(z,{onClick:s},{default:l(()=>[...o[12]||(o[12]=[g("取消",-1)])]),_:1}),e(z,{type:"primary",onClick:t},{default:l(()=>[...o[13]||(o[13]=[g("确定",-1)])]),_:1})]),default:l(()=>[e(F,{model:i.value,"label-width":k(d)?"0px":"120px","label-position":k(d)?"top":"right"},{default:l(()=>[e(a,{label:"项目名称"},{default:l(()=>[e(C,{modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=y=>i.value.name=y)},null,8,["modelValue"])]),_:1}),e(a,{label:"模式"},{default:l(()=>[e(M,{modelValue:i.value.mode,"onUpdate:modelValue":o[1]||(o[1]=y=>i.value.mode=y)},{default:l(()=>[e($,{label:"free"},{default:l(()=>[...o[9]||(o[9]=[g("免费",-1)])]),_:1}),e($,{label:"paid"},{default:l(()=>[...o[10]||(o[10]=[g("付费",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"版本号"},{default:l(()=>[e(C,{modelValue:i.value.version,"onUpdate:modelValue":o[2]||(o[2]=y=>i.value.version=y)},null,8,["modelValue"])]),_:1}),e(a,{label:"更新地址"},{default:l(()=>[e(C,{modelValue:i.value.update_url,"onUpdate:modelValue":o[3]||(o[3]=y=>i.value.update_url=y),placeholder:"可选，用于客户端检查更新"},null,8,["modelValue"])]),_:1}),e(a,{label:"Token有效期"},{default:l(()=>[e(C,{modelValue:i.value.token_expire,"onUpdate:modelValue":o[4]||(o[4]=y=>i.value.token_expire=y),modelModifiers:{number:!0},type:"number"},{append:l(()=>[...o[11]||(o[11]=[g("秒",-1)])]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"启用机器码"},{default:l(()=>[e(N,{modelValue:i.value.enable_hwid,"onUpdate:modelValue":o[5]||(o[5]=y=>i.value.enable_hwid=y)},null,8,["modelValue"])]),_:1}),e(a,{label:"启用IP验证"},{default:l(()=>[e(N,{modelValue:i.value.enable_ip,"onUpdate:modelValue":o[6]||(o[6]=y=>i.value.enable_ip=y)},null,8,["modelValue"])]),_:1}),e(a,{label:"描述"},{default:l(()=>[e(C,{modelValue:i.value.description,"onUpdate:modelValue":o[7]||(o[7]=y=>i.value.description=y),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","label-width","label-position"])]),_:1},8,["modelValue","title","width","fullscreen"])])}}},it=U(nt,[["__scopeId","data-v-ec0545ff"]]),dt={__name:"ProjectBatchCreateDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","save"],setup(p,{emit:j}){const d=p,m=j,f=w(!1),u=w("");A(()=>d.visible,s=>{f.value=s,s&&(u.value="")}),A(f,s=>{m("update:visible",s)});const i=()=>{f.value=!1},V=()=>{m("save",u.value)};return(s,t)=>{const v=c("el-alert"),_=c("el-input"),o=c("el-button"),C=c("el-dialog");return h(),B(C,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=a=>f.value=a),title:"批量创建项目",width:"700px",onClose:i},{footer:l(()=>[e(o,{onClick:i},{default:l(()=>[...t[3]||(t[3]=[g("取消",-1)])]),_:1}),e(o,{type:"primary",onClick:V},{default:l(()=>[...t[4]||(t[4]=[g("确定创建",-1)])]),_:1})]),default:l(()=>[e(v,{type:"info",closable:!1,style:{"margin-bottom":"15px"}},{default:l(()=>[...t[2]||(t[2]=[g(' 请输入JSON格式的项目数据,格式: [{"name": "项目名", "mode": "free", ...}, ...] ',-1)])]),_:1}),e(_,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),type:"textarea",rows:12,placeholder:`[\r
  {\r
    "name": "项目1",\r
    "mode": "free",\r
    "version": "1.0.0",\r
    "token_expire": 3600,\r
    "enable_hwid": true,\r
    "enable_ip": true,\r
    "description": "描述"\r
  }\r
]`},null,8,["modelValue"])]),_:1},8,["modelValue"])}}},rt=U(dt,[["__scopeId","data-v-7fa2df46"]]),ut={class:"page-container"},ct={class:"header-actions"},pt={__name:"Projects",setup(p){const j=ue(),d=w(!1),m=w([]),f=w(!1),u=w(!1),i=w(""),V=w(!1),s=w(null),t=w(null),{selectedItems:v,handleSelectionChange:_}=fe(),o=R(()=>m.value.filter(r=>r.mode==="paid").length),C=R(()=>m.value.filter(r=>r.mode==="free").length),a=async()=>{d.value=!0;try{m.value=await _e()}catch(r){console.error(r)}finally{d.value=!1}},$=()=>{V.value=!1,i.value="创建项目",t.value=null,f.value=!0},M=r=>{V.value=!0,i.value="编辑项目",s.value=r.id,t.value={...r},f.value=!0},N=async r=>{try{V.value?(await ye(s.value,r),D.success("更新成功")):(await ke(r),D.success("创建成功")),f.value=!1,a()}catch(b){console.error(b)}},F=r=>{J.confirm("确定要删除该项目吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await ge(r.id),D.success("删除成功"),a()}catch(b){console.error(b)}}).catch(()=>{})},z=r=>{j.push(`/cards/${r.id}`)},L=r=>{j.push(`/cloudvars/${r.id}`)},y=()=>{u.value=!0},Y=async r=>{try{const b=JSON.parse(r);if(!Array.isArray(b)){D.error("数据格式错误,必须是数组");return}const E=b.map(x=>({name:x.name,mode:x.mode||"free",version:x.version||"1.0.0",token_expire:x.token_expire||3600,enable_hwid:x.enable_hwid!==!1,enable_ip:x.enable_ip!==!1,description:x.description||""}));await Ce({data:E}),D.success(`成功创建 ${E.length} 个项目`),u.value=!1,a()}catch(b){b instanceof SyntaxError?D.error("JSON格式错误,请检查"):console.error(b)}},Z=()=>{J.confirm(`确定要删除选中的 ${v.value.length} 个项目吗?`,"批量删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await be({ids:v.value.map(r=>r.id)}),D.success(`成功删除 ${v.value.length} 个项目`),v.value=[],a()}catch(r){console.error(r)}}).catch(()=>{})};return G(()=>{a()}),(r,b)=>{const E=c("el-icon"),x=c("el-button"),ee=c("el-card");return h(),P("div",ut,[e(Fe,{"total-count":m.value.length,"paid-count":o.value,"free-count":C.value},null,8,["total-count","paid-count","free-count"]),e(ee,{class:"main-card card-modern"},{default:l(()=>[n("div",ct,[e(x,{type:"primary",onClick:$},{default:l(()=>[e(E,null,{default:l(()=>[e(k(ce))]),_:1}),b[2]||(b[2]=g(" 创建项目 ",-1))]),_:1}),e(x,{type:"success",onClick:y,style:{"margin-left":"10px"}},{default:l(()=>[...b[3]||(b[3]=[g(" 批量创建 ",-1)])]),_:1}),e(x,{type:"danger",onClick:Z,disabled:k(v).length===0},{default:l(()=>[...b[4]||(b[4]=[g(" 批量删除 ",-1)])]),_:1},8,["disabled"])]),e(ot,{projects:m.value,loading:d.value,onSelectionChange:k(_),onEdit:M,onViewCards:z,onViewVars:L,onDelete:F},null,8,["projects","loading","onSelectionChange"])]),_:1}),e(it,{visible:f.value,"onUpdate:visible":b[0]||(b[0]=O=>f.value=O),title:i.value,"project-data":t.value,onSave:N},null,8,["visible","title","project-data"]),e(rt,{visible:u.value,"onUpdate:visible":b[1]||(b[1]=O=>u.value=O),onSave:Y},null,8,["visible"])])}}},bt=U(pt,[["__scopeId","data-v-602fd33e"]]);export{bt as default};
